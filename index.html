<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Taya Navi</title>

<style>
body{
  font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
  background:#0f1117;
  color:#eaeef3;
  margin:0;
  padding:30px;
}
h1{margin:0 0 6px 0}
small{color:#9aa3b2}
.container{max-width:1100px;margin:auto}
.card{
  background:#171a23;
  padding:20px;
  border-radius:14px;
  margin-bottom:20px;
}
textarea,input,select{
  width:100%;
  background:#0f1117;
  color:#eaeef3;
  border:1px solid #2a2f3c;
  border-radius:10px;
  padding:10px;
  margin-top:6px;
  font-size:14px;
}
button{
  padding:10px 14px;
  border-radius:10px;
  border:1px solid #2a2f3c;
  background:#202636;
  color:white;
  cursor:pointer;
  margin-right:10px;
}
button.primary{
  background:#2f5eff;
  border:none;
}
.row{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.status{margin-top:12px;font-size:13px}
.good{color:#7ef0c1}
.warn{color:#ffcc66}
.bad{color:#ff6b6b}
.output{min-height:160px}
</style>
</head>

<body>
<div class="container">

<h1>Taya Navi v2.1</h1>
<small>Paste company names (any delimiter). Former mode auto-excludes current employees.</small>

<div class="card">
<label><b>Company Names</b></label>
<textarea id="companies" placeholder="Example:
Takasago, T. Hasegawa / IFF；ADM・DSM Firmenich"></textarea>

<div class="row">
<div>
<label><b>Mode</b></label>
<select id="mode">
<option value="PAST">Former only (exclude current)</option>
<option value="CURRENT">Current only</option>
<option value="BOTH">Both (Current + Past)</option>
</select>
</div>

<div>
<label><b>Industry Template</b></label>
<select id="template">
<option value="generic">Generic</option>
<option value="ff">Fragrance & Flavor</option>
<option value="dc">Data Center</option>
<option value="chem">Chemicals</option>
<option value="energy">Energy</option>
</select>
</div>
</div>

<br>

<button class="primary" onclick="build()">Generate URL</button>
<button onclick="copyURL()">Copy URL</button>
<button onclick="openURL()">Open URL</button>

<div id="status" class="status"></div>
</div>

<div class="card">
<label><b>Generated URL</b></label>
<textarea id="output" class="output" readonly></textarea>

<label><b>Expanded Keywords</b></label>
<textarea id="expanded" class="output" readonly></textarea>
</div>

</div>

<script>

// ===== Multi-delimiter split =====
const SPLIT_REGEX = /[\r\n,，、:：・\/\\;；]+/g;

// ===== Global suffix removal =====
const JP_SUFFIXES = ["株式会社","有限会社","合同会社","合資会社","合名会社","（株）","（有）","㈱","㈲"];

const EN_SUFFIX_PATTERNS = [
/\bco\.\s*ltd\.?$/i,
/\bltd\.?$/i,
/\blimited$/i,
/\binc\.?$/i,
/\bincorporated$/i,
/\bcorp\.?$/i,
/\bcorporation$/i,
/\bllc\.?$/i,
/\bplc\.?$/i,
/\bag$/i,
/\bgmbh$/i,
/\bs\.a\.?$/i,
/\bs\.p\.a\.?$/i,
/\bb\.v\.?$/i,
/\bn\.v\.?$/i,
/\bpty\.?\s*ltd\.?$/i,
/\bk\.k\.?$/i,
/\bkk$/i
];

function stripSuffix(name){
  let s = name.trim();
  JP_SUFFIXES.forEach(j=>{ if(s.endsWith(j)) s=s.replace(j,"").trim(); });
  EN_SUFFIX_PATTERNS.forEach(re=>{ s=s.replace(re,"").trim(); });
  return s;
}

function uniq(arr){
  return [...new Set(arr.map(x=>x.trim()).filter(Boolean))];
}

function encodeCompany(name){
  const once = encodeURIComponent(name);
  return once.replace(/%/g,"%25");
}

function build(){
  const input = document.getElementById("companies").value;
  const mode = document.getElementById("mode").value;

  let names = input.split(SPLIT_REGEX);
  let expanded = [];

  names.forEach(n=>{
    expanded.push(n);
    expanded.push(stripSuffix(n));
  });

  expanded = uniq(expanded);

  document.getElementById("expanded").value = expanded.join("\n");

  function values(list,type){
    return list.map(n=>`(text%3A${encodeCompany(n)}%2CselectionType%3A${type})`).join("%2C");
  }

  let query="";

  if(mode==="PAST"){
    query=`(recentSearchParam%3A(doLogHistory%3Atrue)%2Cfilters%3AList(
(type%3APAST_COMPANY%2Cvalues%3AList(${values(expanded,"INCLUDED")}))%2C
(type%3ACURRENT_COMPANY%2Cvalues%3AList(${values(expanded,"EXCLUDED")}))
))`;
  }
  else if(mode==="CURRENT"){
    query=`(recentSearchParam%3A(doLogHistory%3Atrue)%2Cfilters%3AList(
(type%3ACURRENT_COMPANY%2Cvalues%3AList(${values(expanded,"INCLUDED")}))
))`;
  }
  else{
    query=`(recentSearchParam%3A(doLogHistory%3Atrue)%2Cfilters%3AList(
(type%3APAST_COMPANY%2Cvalues%3AList(${values(expanded,"INCLUDED")}))%2C
(type%3ACURRENT_COMPANY%2Cvalues%3AList(${values(expanded,"INCLUDED")}))
))`;
  }

  const url=`https://www.linkedin.com/sales/search/people?query=${query}&viewAllFilters=true`;
  document.getElementById("output").value=url;

  document.getElementById("status").innerHTML=
    `<span class="good">Done. ${expanded.length} keywords generated.</span>`;
}

function copyURL(){
  navigator.clipboard.writeText(document.getElementById("output").value);
}

function openURL(){
  window.open(document.getElementById("output").value,"_blank");
}

</script>
</body>
</html>
